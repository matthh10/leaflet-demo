[
  {
    "objectID": "slides.html#overview",
    "href": "slides.html#overview",
    "title": "How to make maps with {leaflet} in R",
    "section": "Overview",
    "text": "Overview\nMaps are often useful in public health to understand the spatial distribution of cases and identify clusters.\n\nThe {leaflet} package in R is useful for quickly creating interactive maps using free, open-source data (Cheng et al. 2025).\n\nUsing publicly available data on GP practices in Scotland and geographical data from the Scottish postcode directory, this tutorial will demonstrate how to produce basic maps using {leaflet} and outline some key features of the package."
  },
  {
    "objectID": "slides.html#load-packages",
    "href": "slides.html#load-packages",
    "title": "How to make maps with {leaflet} in R",
    "section": "Load Packages",
    "text": "Load Packages\nFirst, we can load in the packages we will use in this analysis:\n\nif(!require(\"pacman\")) {\n  install.packages(\"pacman\")\n}\n\npacman::p_load(tidyverse, # For data wrangling and vis \n               leaflet, # For making interactive maps\n               phsopendata, # For gp data\n               phslookups, # For converting postcodes to coordinates\n               phmethods, # For formatting poscodes\n               janitor, # For cleaning data\n               purrr, # For working with lists\n               htmltools, glue) # For making nice labels"
  },
  {
    "objectID": "slides.html#load-in-data",
    "href": "slides.html#load-in-data",
    "title": "How to make maps with {leaflet} in R",
    "section": "Load in Data",
    "text": "Load in Data\nWe will be using data from {phsopendata} on GP locations and size in Scotland (Scharle et al. 2025).\n\ngp_data &lt;- phsopendata::get_dataset(\"gp-practice-contact-details-and-list-sizes\") |&gt; \n  janitor::clean_names()  # Tidys column names\n\nglimpse(gp_data)\n\nRows: 39,808\nColumns: 19\n$ practice_code      &lt;dbl&gt; 10002, 10017, 10036, 10106, 10125, 10182, 10233, 10…\n$ gp_practice_name   &lt;chr&gt; \"Muirhead Medical Centre\", \"The Blue Practice\", \"Ab…\n$ practice_list_size &lt;chr&gt; \"8491\", \"7706\", \"4861\", \"6442\", \"4669\", \"9728\", \"70…\n$ address_line1      &lt;chr&gt; \"Muirhead Medical Centre\", \"The Blue Practice\", \"Ab…\n$ address_line2      &lt;chr&gt; \"Liff Road\", \"Crieff Medical Centre\", \"Taybridge Ro…\n$ address_line3      &lt;chr&gt; \"Muirhead\", \"King Street\", \"Aberfeldy\", \"Broughty F…\n$ address_line4      &lt;chr&gt; NA, \"Crieff\", \"Perthshire\", \"Dundee\", NA, NA, NA, N…\n$ postcode           &lt;chr&gt; \"DD2 5NH\", \"PH7 3SA\", \"PH15 2BL\", \"DD5 1DU\", \"PH11 …\n$ telephone_number   &lt;chr&gt; \"01382 580 264\", \"01764 652 283\", \"01887 820 366\", …\n$ practice_type      &lt;chr&gt; \"GMS\", \"GMS\", \"GMS\", \"GMS\", \"GMS\", \"GMS\", \"2C\", \"GM…\n$ dispensing         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ hb                 &lt;chr&gt; \"S08000030\", \"S08000030\", \"S08000030\", \"S08000030\",…\n$ hscp               &lt;chr&gt; \"S37000007\", \"S37000033\", \"S37000033\", \"S37000007\",…\n$ data_zone          &lt;chr&gt; \"S01007129\", \"S01011870\", \"S01012014\", \"S01007758\",…\n$ gp_cluster         &lt;chr&gt; \"Dundee 4\", \"Strathearn Cluster\", \"North West Perth…\n$ practice_name      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ listsize           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ telephone          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ca                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…"
  },
  {
    "objectID": "slides.html#section",
    "href": "slides.html#section",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "Some practices are duplicated so we will only keep one entry per practice code, keeping the entry with the largest list size.\n\n\ngp_data_filtered &lt;- gp_data |&gt; \n  mutate(practice_code = as.factor(practice_code),\n         practice_list_size = as.numeric(practice_list_size)) |&gt; \n  group_by(practice_code) |&gt; \n  slice_max(practice_list_size, n = 1) |&gt; \n  ungroup()"
  },
  {
    "objectID": "slides.html#extract-geographic-data",
    "href": "slides.html#extract-geographic-data",
    "title": "How to make maps with {leaflet} in R",
    "section": "Extract geographic data",
    "text": "Extract geographic data\n\n\nThe data set from {phsopendata} includes the postcode (gp_data$postcode) for each practice in Scotland.\n\nTo plot each practice on a map, we must first convert these postcodes into map coordinates (latitude and longitude).\n\nWe can do this using the Scottish postcode directory, which can be loaded into the R environment using {phslookups}.\n\n\nspd &lt;- phslookups::get_spd()  \nglimpse(spd)\n\nRows: 229,249\nColumns: 95\n$ pc7                     &lt;chr&gt; \"AB1 0AA\", \"AB1 0AB\", \"AB1 0AD\", \"AB1 0AE\", \"A…\n$ pc8                     &lt;chr&gt; \"AB1 0AA\", \"AB1 0AB\", \"AB1 0AD\", \"AB1 0AE\", \"A…\n$ split_char              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ pc_district             &lt;chr&gt; \"AB1\", \"AB1\", \"AB1\", \"AB1\", \"AB1\", \"AB1\", \"AB1…\n$ pc_sector               &lt;chr&gt; \"AB1 0\", \"AB1 0\", \"AB1 0\", \"AB1 0\", \"AB1 0\", \"…\n$ date_of_introduction    &lt;date&gt; 1980-01-01, 1973-08-01, 1973-08-01, 1994-02-0…\n$ date_of_deletion        &lt;date&gt; 1996-06-01, 1996-04-01, 1996-04-01, 1996-04-0…\n$ postcode_type           &lt;chr&gt; \"S\", \"S\", \"S\", \"S\", \"L\", \"L\", \"S\", \"S\", \"L\", \"…\n$ pc_su_link              &lt;chr&gt; NA, NA, NA, NA, \"AB14 0QL\", \"AB14 0SB\", NA, NA…\n$ split_su_link           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ imputed                 &lt;chr&gt; NA, NA, NA, NA, \"Y\", \"Y\", NA, NA, \"Y\", NA, NA,…\n$ dpc                     &lt;int&gt; 1, 4, 8, 3, NA, NA, 3, 5, NA, 6, 1, 10, 19, 10…\n$ dpc_nr                  &lt;int&gt; 0, 1, 0, 0, NA, NA, 0, 0, NA, 0, 0, 0, 0, 1, 0…\n$ hhc                     &lt;int&gt; 1, 0, 0, 0, NA, NA, 0, 0, NA, 0, 0, 0, 0, 0, 0…\n$ grid_reference_easting  &lt;int&gt; 385386, 384939, 384939, 384599, 384460, 383890…\n$ grid_reference_northing &lt;int&gt; 801193, 801420, 800980, 799300, 800660, 800710…\n$ latitude                &lt;dbl&gt; 57.10148, 57.10351, 57.09955, 57.08445, 57.096…\n$ longitude               &lt;dbl&gt; -2.242872, -2.250264, -2.250237, -2.255745, -2…\n$ split_indicator         &lt;chr&gt; \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"…\n$ ca2019                  &lt;chr&gt; \"S12000033\", \"S12000033\", \"S12000033\", \"S12000…\n$ ca2019name              &lt;chr&gt; \"Aberdeen City\", \"Aberdeen City\", \"Aberdeen Ci…\n$ ca2018                  &lt;chr&gt; \"S12000033\", \"S12000033\", \"S12000033\", \"S12000…\n$ ca2011                  &lt;chr&gt; \"S12000033\", \"S12000033\", \"S12000033\", \"S12000…\n$ upc2024                 &lt;chr&gt; \"S14000061\", \"S14000061\", \"S14000061\", \"S14000…\n$ spr2021                 &lt;chr&gt; \"S17000014\", \"S17000014\", \"S17000014\", \"S17000…\n$ spc2021                 &lt;chr&gt; \"S16000076\", \"S16000076\", \"S16000076\", \"S16000…\n$ ew2022                  &lt;chr&gt; \"S13002843\", \"S13002843\", \"S13002843\", \"S13002…\n$ hb2019                  &lt;chr&gt; \"S08000020\", \"S08000020\", \"S08000020\", \"S08000…\n$ hb2019name              &lt;chr&gt; \"NHS Grampian\", \"NHS Grampian\", \"NHS Grampian\"…\n$ hb2018                  &lt;chr&gt; \"S08000020\", \"S08000020\", \"S08000020\", \"S08000…\n$ hb2014                  &lt;chr&gt; \"S08000020\", \"S08000020\", \"S08000020\", \"S08000…\n$ hb2006                  &lt;chr&gt; \"S08000006\", \"S08000006\", \"S08000006\", \"S08000…\n$ hb1995                  &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…\n$ hscp2019                &lt;chr&gt; \"S37000001\", \"S37000001\", \"S37000001\", \"S37000…\n$ hscp2019name            &lt;chr&gt; \"Aberdeen City\", \"Aberdeen City\", \"Aberdeen Ci…\n$ hscp2018                &lt;chr&gt; \"S37000001\", \"S37000001\", \"S37000001\", \"S37000…\n$ hscp2016                &lt;chr&gt; \"S37000001\", \"S37000001\", \"S37000001\", \"S37000…\n$ oa2022                  &lt;chr&gt; \"S00137176\", \"S00137176\", \"S00137176\", \"S00138…\n$ oa2011                  &lt;chr&gt; \"S00090303\", \"S00090303\", \"S00090399\", \"S00091…\n$ oa2001                  &lt;chr&gt; \"S00001364\", \"S00001270\", \"S00001364\", \"S00002…\n$ oa1991                  &lt;chr&gt; \"6015AK12A\", \"6015AK12A\", \"6015AK11A\", \"6018AC…\n$ datazone2022            &lt;chr&gt; \"S01013490\", \"S01013490\", \"S01013490\", \"S01013…\n$ datazone2022name        &lt;chr&gt; \"Cults, Bieldside and Milltimber West - 02\", \"…\n$ datazone2011            &lt;chr&gt; \"S01006514\", \"S01006514\", \"S01006514\", \"S01006…\n$ datazone2001            &lt;chr&gt; \"S01000011\", \"S01000011\", \"S01000011\", \"S01000…\n$ intzone2022             &lt;chr&gt; \"S02002516\", \"S02002516\", \"S02002516\", \"S02002…\n$ intzone2022name         &lt;chr&gt; \"Cults, Bieldside and Milltimber West\", \"Cults…\n$ intzone2011             &lt;chr&gt; \"S02001237\", \"S02001237\", \"S02001237\", \"S02001…\n$ intzone2001             &lt;chr&gt; \"S02000007\", \"S02000007\", \"S02000007\", \"S02000…\n$ hhc2022                 &lt;int&gt; NA, NA, NA, NA, 0, 0, NA, NA, 0, NA, NA, NA, N…\n$ pop2022                 &lt;int&gt; NA, NA, NA, NA, 0, 0, NA, NA, 0, NA, NA, NA, N…\n$ hhc2011                 &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ pop2011                 &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ hhc2001                 &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ pop2001                 &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ hhc1991                 &lt;int&gt; 1, 1, 7, NA, NA, NA, 3, 3, NA, 0, 1, 9, 17, 9,…\n$ pop1991                 &lt;int&gt; 2, 3, 21, NA, NA, NA, 7, 11, NA, 0, 1, 28, 49,…\n$ simd2020_rank           &lt;int&gt; 6715, 6715, 6715, 5069, 6253, 4691, 6715, 6253…\n$ lau_level1_2025         &lt;chr&gt; \"S30000026\", \"S30000026\", \"S30000026\", \"S30000…\n$ itl2025level2code       &lt;chr&gt; \"TLM5\", \"TLM5\", \"TLM5\", \"TLM5\", \"TLM5\", \"TLM5\"…\n$ itl2025level3code       &lt;chr&gt; \"TLM50\", \"TLM50\", \"TLM50\", \"TLM50\", \"TLM50\", \"…\n$ locality_2022           &lt;chr&gt; \"S52000446\", \"S52000446\", \"S52000446\", NA, \"S5…\n$ locality_2020           &lt;chr&gt; \"S19002370\", \"S19002370\", \"S19002370\", NA, \"S1…\n$ locality_2001           &lt;chr&gt; NA, \"402001\", NA, NA, \"402001\", \"402001\", NA, …\n$ locality_1991           &lt;chr&gt; \"002\", \"002\", \"002\", NA, \"002\", \"002\", \"002\", …\n$ settlement_2022         &lt;chr&gt; \"S53000002\", \"S53000002\", \"S53000002\", NA, \"S5…\n$ settlement_2020         &lt;chr&gt; \"S20001539\", \"S20001539\", \"S20001539\", NA, \"S2…\n$ settlement_2001         &lt;chr&gt; NA, \"402\", NA, NA, \"402\", \"402\", NA, NA, NA, N…\n$ civil_parish_1930       &lt;chr&gt; \"S35000689\", \"S35000689\", \"S35000689\", \"S35000…\n$ ent_region_2008         &lt;chr&gt; \"S09000001\", \"S09000001\", \"S09000001\", \"S09000…\n$ island                  &lt;chr&gt; \"000\", \"000\", \"000\", \"000\", \"000\", \"000\", \"000…\n$ lgd_1995                &lt;int&gt; 15, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 18…\n$ lgd_1991                &lt;int&gt; 15, 15, 15, 18, 15, 15, 15, 15, 15, 15, 15, 18…\n$ nat_park_2010           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ reg_dist_2007           &lt;chr&gt; \"S12000033\", \"S12000033\", \"S12000033\", \"S12000…\n$ roa_cpp_2006            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ roa_local_2006          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ sdpa_2013               &lt;chr&gt; \"S11000001\", \"S11000001\", \"S11000001\", \"S11000…\n$ ttwa_2011               &lt;chr&gt; \"S22000047\", \"S22000047\", \"S22000047\", \"S22000…\n$ chp_2012                &lt;chr&gt; \"S03000012\", \"S03000012\", \"S03000012\", \"S03000…\n$ chp_2011                &lt;chr&gt; \"S03000012\", \"S03000012\", \"S03000012\", \"S03000…\n$ chp_Sub_2011            &lt;chr&gt; \"S26000012\", \"S26000012\", \"S26000012\", \"S26000…\n$ chp_2007                &lt;chr&gt; \"S03000012\", \"S03000012\", \"S03000012\", \"S03000…\n$ chp_2004                &lt;chr&gt; \"S03000012\", \"S03000012\", \"S03000012\", \"S03000…\n$ ur2_2022                &lt;int&gt; 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2…\n$ ur2_2022_name           &lt;chr&gt; \"1 Rest of Scotland\", \"1 Rest of Scotland\", \"1…\n$ ur3_2022                &lt;int&gt; 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2…\n$ ur3_2022_name           &lt;chr&gt; \"1 Rest of Scotland\", \"1 Rest of Scotland\", \"1…\n$ ur6_2022                &lt;int&gt; 1, 1, 1, 5, 1, 1, 1, 1, 5, 5, 1, 5, 5, 5, 5, 5…\n$ ur6_2022_name           &lt;chr&gt; \"1 Large Urban Areas\", \"1 Large Urban Areas\", …\n$ ur8_2022                &lt;int&gt; 1, 1, 1, 6, 1, 1, 1, 1, 6, 6, 1, 6, 6, 6, 6, 6…\n$ ur8_2022_name           &lt;chr&gt; \"1 Large Urban Areas\", \"1 Large Urban Areas\", …\n$ gridlink_ind            &lt;chr&gt; \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"…\n$ gridlink_pos_accuracy   &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ never_digitised         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…"
  },
  {
    "objectID": "slides.html#section-1",
    "href": "slides.html#section-1",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "This loads in a tibble with columns on geographic metadata for each postcode in Scotland.\n\nGP postcodes must be converted into the pc8 format before joining the coordinates.\n\n\ngeo_data &lt;- gp_data_filtered |&gt; \n  select(practice_code, practice_list_size, \n         gp_practice_name, postcode, gp_cluster) |&gt;\n  # Ensure all postcodes are in PC8 format\n  mutate(pc8 = phsmethods::format_postcode(postcode, format = \"pc8\")) |&gt;\n  left_join(\n    spd |&gt; \n      select(pc8, latitude, longitude, hb2019name), # Select required columns\n    join_by(pc8) # Join using the pc8 column\n  )"
  },
  {
    "objectID": "slides.html#create-map",
    "href": "slides.html#create-map",
    "title": "How to make maps with {leaflet} in R",
    "section": "Create map",
    "text": "Create map\n\n\nNow that we have a data frame with the coordinates and list size of each GP practice in Scotland, we can begin building a map.\n\nWe will first create a map widget by calling the leaflet() function and piping that into addTiles, which by default load OpenStreetMap data into our map widget as a new layer. We can then set the map view to show Scotland and define an appropriate default zoom using setView().\n\n\nm &lt;- leaflet() |&gt; # Create map widget\n  addTiles() |&gt; # Add map tile layer (defaults to OSM)\n  setView(-4.57, 57.88, zoom = 6) # Geographical centre of Scotland\n\nm"
  },
  {
    "objectID": "slides.html#add-markers-and-popups",
    "href": "slides.html#add-markers-and-popups",
    "title": "How to make maps with {leaflet} in R",
    "section": "Add markers and popups",
    "text": "Add markers and popups\nWe can add markers and popups to our map widget using addMarkers and addPopups:\n\nm |&gt;  \n  addMarkers(lng = -4.2654064, 55.8614359)"
  },
  {
    "objectID": "slides.html#section-2",
    "href": "slides.html#section-2",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "Popups include the option to add text:\n\nm |&gt;  \n  addPopups(lng = -4.2654064, lat = 55.8614359, popup = 'This is 177 Bothwell Street')"
  },
  {
    "objectID": "slides.html#add-gp-practices",
    "href": "slides.html#add-gp-practices",
    "title": "How to make maps with {leaflet} in R",
    "section": "Add GP practices",
    "text": "Add GP practices\nWe can use the geographical data we produced earlier to add a marker for each GP practice in Scotland:\n\nm |&gt;\n  addMarkers(data = geo_data, # Data frame we produed earlier\n             lng = ~ longitude, # Column with longitude coordinates\n             lat = ~ latitude) # Column with latitude coordinates"
  },
  {
    "objectID": "slides.html#section-3",
    "href": "slides.html#section-3",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "Markers look a bit cluttered, so we can use circle markers instead:\n\nm |&gt;\n  addCircleMarkers(data = geo_data,\n                   lng = ~ longitude,\n                   lat = ~ latitude,\n                   radius = 0.5, # Set size of markers\n                   opacity = 0.3) # Set opacity of markers"
  },
  {
    "objectID": "slides.html#section-4",
    "href": "slides.html#section-4",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "Still looks quite cluttered so we can set the clusterOptions argument to cluster markers by proximity:\n\nm |&gt;\n  addMarkers(\n    data = geo_data,\n    lng = ~ longitude,\n    lat = ~ latitude,\n    clusterOptions = markerClusterOptions()\n  )"
  },
  {
    "objectID": "slides.html#add-labels",
    "href": "slides.html#add-labels",
    "title": "How to make maps with {leaflet} in R",
    "section": "Add labels",
    "text": "Add labels\nLabels can also be added to markers using the popup argument inside addMarkers() :\n\nm |&gt;\n  addMarkers(\n    data = geo_data,\n    lng = ~ longitude,\n    lat = ~ latitude,\n    clusterOptions = markerClusterOptions(),\n    popup = ~ gp_practice_name)"
  },
  {
    "objectID": "slides.html#section-5",
    "href": "slides.html#section-5",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "We can write a function to create labels with html formatting using {htmltools}:\n\nmake_nice_label &lt;- function(gp_practice_name, practice_list_size, hb2019name) {\n  name_label &lt;- htmltools::span(\n    glue::glue('Practice name: {gp_practice_name}'),\n    style = htmltools::css(\n      font_weight = 600,\n      font_size = '16px'\n    )\n  )\n  size_label &lt;- htmltools::span(\n    glue::glue('List size: {practice_list_size}'),\n    style = htmltools::css(\n      font_size = '14px'\n    )\n  )\n  hb_label &lt;- htmltools::span(\n    glue::glue('Health board: {hb2019name}'),\n    style = htmltools::css(\n      font_size = '14px'\n    )\n  )\n  glue::glue('{name_label}&lt;br&gt;{size_label}&lt;br&gt;{hb_label}')\n}\n\ngeo_data_labeled &lt;- geo_data |&gt; \n  mutate(nice_label = pmap(\n           list(\n             gp_practice_name, practice_list_size, hb2019name\n           ),\n           make_nice_label\n         ))"
  },
  {
    "objectID": "slides.html#section-6",
    "href": "slides.html#section-6",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "m |&gt;\n  addMarkers(\n    data = geo_data_labeled,\n    lng = ~ longitude,\n    lat = ~ latitude,\n    clusterOptions = markerClusterOptions(), \n    clusterId = \"GP Practices\",\n    popup = ~nice_label\n    )"
  },
  {
    "objectID": "slides.html#conditional-markers",
    "href": "slides.html#conditional-markers",
    "title": "How to make maps with {leaflet} in R",
    "section": "Conditional markers",
    "text": "Conditional markers\nWe can also include conditional formatting for markers. These can work on continuous variables such as practice_list_size:\n\ngeo_data_big &lt;- geo_data |&gt; \n  filter(practice_list_size &gt;= 10000) # Filter for only large practices\n\npal_list_size &lt;- colorNumeric(palette = \"viridis\", domain = c(0, max(geo_data_big$practice_list_size)))"
  },
  {
    "objectID": "slides.html#section-7",
    "href": "slides.html#section-7",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "m |&gt;\n  addCircleMarkers(\n    data = geo_data_big,\n    lng = ~ longitude,\n    lat = ~ latitude,\n    stroke = FALSE,\n    fillOpacity = 0.8,\n    radius = 6,\n    color = ~ pal_list_size(practice_list_size)\n  ) |&gt;\n  addLegend(\n    data = geo_data_big,\n    position = \"bottomright\",\n    pal = pal_list_size,\n    values = ~ practice_list_size,\n    title = \"Practice list size\",\n    opacity = 1\n  )"
  },
  {
    "objectID": "slides.html#section-8",
    "href": "slides.html#section-8",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "We can also use categorical variables to create conditional markers. To demonstrate this, we can create a new column called size_group which divides practices into discrete groups based on practice_list_size :\n\nsize_breaks &lt;- c(0, 5000, 10000, 15000, Inf)\nsize_labels &lt;- c(\"&lt;5000\", \"5000-10,000\", \"10,000-15,000\", \"&gt;15,000\")\n\ngeo_data_grouped &lt;- geo_data |&gt;\n  # Only keep practices with list size\n  filter(!is.na(practice_list_size), practice_list_size &gt; 0) |&gt; \n  # Create new discrete groups for practice size\n  mutate(size_group = cut(practice_list_size, breaks = size_breaks, labels = size_labels)) |&gt; \n  # Keep only 100 practices for plotting\n  slice_sample(n = 100) \n\npal_size_group &lt;- colorFactor(\n  palette = c(\"green\", \"yellow\", \"orange\", \"red\"),\n  levels = levels(geo_data_grouped$size_group)\n)"
  },
  {
    "objectID": "slides.html#section-9",
    "href": "slides.html#section-9",
    "title": "How to make maps with {leaflet} in R",
    "section": "",
    "text": "m |&gt;\n  addCircleMarkers(\n    data = geo_data_grouped,\n    lng = ~ longitude,\n    lat = ~ latitude,\n    stroke = FALSE,\n    fillOpacity = 0.6,\n    radius = 6,\n    color = ~ pal_size_group(size_group)\n  ) |&gt; \n  addLegend(\n    data = geo_data_grouped,\n    position = \"bottomright\",\n    pal = pal_size_group,\n    values = ~ size_group,\n    title = \"Practice list size\",\n    opacity = 1\n  )"
  },
  {
    "objectID": "slides.html#recap",
    "href": "slides.html#recap",
    "title": "How to make maps with {leaflet} in R",
    "section": "Recap",
    "text": "Recap\n\nLeaflet is an open and free to use package (as long as you credit the contributors) that can be used to make maps in R\naddMarkers can be used to tag locations of interest\naddPopups can be used to add text to marked locations\ncolourFactor and colourNumeric can be used to add conditional formatting to markers\n\n\nThanks for following along and go give it a go yourself!"
  },
  {
    "objectID": "slides.html#references",
    "href": "slides.html#references",
    "title": "How to make maps with {leaflet} in R",
    "section": "References",
    "text": "References\nThe slides and tutorial are available on GitHub: matthh10/leaflet-demo\n\n\n\n\n\nCheng, Joe, Barret Schloerke, Bhaskar Karambelkar, Yihui Xie, and Garrick Aden-Buie. 2025. “Leaflet: Create Interactive Web Maps with the JavaScript ’Leaflet’ Library.” https://rstudio.github.io/leaflet/.\n\n\nScharle, Csilla, James Hayes, David Aikman, and Ross Hull. 2025. “Phsopendata: Extract from the Scottish Health and Social Care Open Data Platform.” https://github.com/Public-Health-Scotland/phsopendata."
  }
]